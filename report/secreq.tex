
\section{Security requirements}
% --- Start of the entire list ---
\begin{enumerate}
% --- Start of Confidentiality ---
\item Confidentiality
	\begin{enumerate}
	\item The card identity number shall only be revealed to the  personalisation/charging/pump terminal after the terminal has been authenticated to the petrol card.
	\item The public key material shall only be revealed to the personalisation/charging/pump terminal after the terminal has been authenticated.
	\item The card usage shall not be revealed to any kind of terminal.
	\item The PIN code shall only be know by the petrol card and the petrol card owner. 
	\item The back end will only update the monthly allowance to the charging terminals after the charging terminal has been authenticated.
	\end{enumerate}
% --- End of Confidentiality ---
%\begin{minipage}{\linewidth}
% --- Start of Integrity ---
\item Integrity
	\begin{enumerate}
	\item The petrol balance on the petrol card can only be altered by an authenticated terminal.
	\item The identity number of the petrol card cannot be altered. 
	\item The public and private keys of the petrol card and terminals cannot be altered.
	\item The logs on the terminal can only be altered by the terminal itself. 
	\end{enumerate}
% --- End of Integrity ---
%\end{minipage}

% --- Start of Authentication ---
\item Authentication during charging
		\begin{enumerate}
		\item The petrol card shall authenticate to the charging terminal by using its public and private key% its identity number (IDnr).
		\item The charging terminal shall authenticate itself to the petrol card  by using its public and private key.
		\item The charging terminal shall authenticate itself to the back-end with the public and private key to receive the monthly petrol allowance that can be written to the petrol cards.
		\end{enumerate}	
		
\item Authentication during pumping
	\begin{enumerate}
	\item The petrol card shall authenticate to the pumping terminal by using its public and private key. % providing its identity number (IDnr).
	\item The pumping terminal shall authenticate itself to the petrol card by using its public and private keys
	\item The pumping terminal shall authenticate itself to the back-end by using its public and private keys.
	\item The card owner shall authenticate to the pumping terminal and petrol card of its ownership by providing the PIN to the petrol card.
	\end{enumerate}		
% --- End of Authentication ---

% --- Start of Authorisation ---
\item Authorisation
	\begin{enumerate}
	\item The charging terminal is only authorised to update the petrol allowance to the petrol card once every month.
	\item The pumping terminal is authorised to withdraw petrol balance during petrol pumping from the petrol card.
	\end{enumerate}
% --- End of Authorisation ---


% --- Start of Non-repudiation ---
\item Non-repudiation
	\begin{enumerate}
%		\item The petrol card shall obtain proof that the allowance value came from the back-end via the charging terminal.
%		\item The petrol card shall obtain proof that the changed allowance value came from the pumping terminal.
		\item The charging terminal can prove to the back-end that it charged the monthly allowance to a valid petrol card. 
		\item The pump terminal can prove to the back-end that it collected petrol allowance from a valid petrol card.
	\end{enumerate}
% --- End of Non-repudiation ---

\end{enumerate}
% --- End of the entire list ---
